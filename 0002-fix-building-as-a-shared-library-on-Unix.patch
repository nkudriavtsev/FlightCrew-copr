From 7c95e46b96e73ca3c8f748825ba02cc518925107 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Dan=20Hor=C3=A1k?= <dan[at]danny.cz>
Date: Wed, 18 Jan 2012 20:38:46 +0100
Subject: [PATCH 02/12] fix building as a shared library on Unix

---
 src/BoostParts/CMakeLists.txt       | 4 ++++
 src/Xerces/CMakeLists.txt           | 3 +++
 src/XercesExtensions/CMakeLists.txt | 4 ++++
 src/zipios/CMakeLists.txt           | 3 +++
 src/zlib/CMakeLists.txt             | 3 +++
 5 files changed, 17 insertions(+)

diff --git a/src/BoostParts/CMakeLists.txt b/src/BoostParts/CMakeLists.txt
index f22410a..a34893c 100644
--- a/src/BoostParts/CMakeLists.txt
+++ b/src/BoostParts/CMakeLists.txt
@@ -105,3 +105,7 @@ if( MSVC )
     set( CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS_RELEASE} /Oi /GL" ) 
     set_target_properties( ${PROJECT_NAME} PROPERTIES STATIC_LIBRARY_FLAGS "/LTCG" )
 endif()
+
+if( UNIX AND BUILD_SHARED_FC )
+    add_definitions(-fPIC)
+endif()
diff --git a/src/Xerces/CMakeLists.txt b/src/Xerces/CMakeLists.txt
index 33ea5c3..9aa896c 100644
--- a/src/Xerces/CMakeLists.txt
+++ b/src/Xerces/CMakeLists.txt
@@ -174,4 +174,7 @@ else()
     # We need to link to pthreads on unix                                 
     target_link_libraries( ${PROJECT_NAME} pthread )
                        
+    if( BUILD_SHARED_FC )
+        add_definitions(-fPIC)
+    endif()
 endif()
diff --git a/src/XercesExtensions/CMakeLists.txt b/src/XercesExtensions/CMakeLists.txt
index 08196e0..96310d2 100644
--- a/src/XercesExtensions/CMakeLists.txt
+++ b/src/XercesExtensions/CMakeLists.txt
@@ -48,6 +48,10 @@ elseif( CMAKE_COMPILER_IS_GNUCXX )
     add_definitions( -Wall )
 endif()
 
+if( UNIX AND BUILD_SHARED_FC )
+    add_definitions(-fPIC)
+endif()
+
 # needed for correct Xerces header inclusion
 add_definitions( -DXERCES_STATIC_LIBRARY )
 
diff --git a/src/zipios/CMakeLists.txt b/src/zipios/CMakeLists.txt
index 88fdb7d..98ce793 100644
--- a/src/zipios/CMakeLists.txt
+++ b/src/zipios/CMakeLists.txt
@@ -47,3 +47,6 @@ elseif( CMAKE_COMPILER_IS_GNUCXX )
     add_definitions( -Wall )
 endif()
 
+if( UNIX AND BUILD_SHARED_FC )
+    add_definitions(-fPIC)
+endif()
diff --git a/src/zlib/CMakeLists.txt b/src/zlib/CMakeLists.txt
index e59f844..fb2638b 100644
--- a/src/zlib/CMakeLists.txt
+++ b/src/zlib/CMakeLists.txt
@@ -133,5 +133,8 @@ if( MSVC )
     set_target_properties( ${PROJECT_NAME} PROPERTIES STATIC_LIBRARY_FLAGS "/LTCG" )
 endif()
 
+if( UNIX AND BUILD_SHARED_FC )
+    add_definitions(-fPIC)
+endif()
 
 
-- 
1.8.5.3

